const getUrl=(u)=>u.replace("https://pimg.mangahigh.com/static/images/prodigi","[[[---IMAGE_PATH---]]]");const fixURL=(u)=>u.replace("[[[---IMAGE_PATH---]]]","https://pimg.mangahigh.com/static/images/prodigi");const getSrc=(content)=>/src="(.*?)"/g.exec(content)[1];const isAnswerMultiple=(a)=>!Boolean(a.hotspots);const sleep=(ms)=>new Promise((r)=>setTimeout(r,ms));const[,id]=/https:\/\/campus.mangahigh.com\/en\/px\/([0-9]+)/g.exec(window.location.href)||[];const answerMap={E:new Map(),M:new Map(),H:new Map(),X:new Map()};const loadMoreQuestions=async()=>{const data=await(await fetch(`https://campus.mangahigh.com/participate/lesson/${ id }`)).json();for(const key of["E","M","H","X"]){for(const answer of data.questions[key]){const a=answer;const src=getSrc(a.content);if(!answerMap[key].has(src)){answerMap[key].set(src,a)}}}};const getDifficulty=()=>{const difficultyStatus=document.querySelector(".prodigi-status-difficulty");switch(difficultyStatus?.innerText){case "EASY":return "E";case "MEDIUM":return "M";case "HARD":return "H";case "EXTREME":return "X";default:throw new Error(`unrecognized difficulty: ${difficultyStatus.innerText }`)}};export const findAnswer=async()=>{await sleep(1000);const content=document.querySelector("#question>div>ul>span>li>img");const difficulty=getDifficulty();while(!answerMap[difficulty].has(getUrl(content.src))){await loadMoreQuestions()}const answer=answerMap[difficulty].get(getUrl(content.src));let isMultiple=isAnswerMultiple(answer);if(isAnswerMultiple(answer)){const correctImage=answer.answers[answer.correctAnswer];const answerSrc=getSrc(fixURL(correctImage));const possibleAnswers=[...document.querySelectorAll(".prodigi-imagecontent.answer")];const correctAnswer=possibleAnswers.filter((a)=>a.innerHTML.includes(answerSrc))[0];if(correctAnswer){correctAnswer.click();return findAnswer()}else{debugger}}const answerDiv=get.answerDiv();answerDiv.innerHTML=fixURL(answer.solutions[0]);const nextButton=document.createElement("button");nextButton.innerText="Find next answer";answerDiv.appendChild(nextButton);nextButton.onclick=findAnswer;const submitButton=document.querySelectorAll(isMultiple?".answer":".submit-button");submitButton.forEach((b)=>b.addEventListener("click",()=>{sleep(1000).then(findAnswer)}))};const get={answerDiv(){const pre=Symbol("preexisting");const answerDiv=document.getElementById("HACKERMAN")||Object.assign(document.createElement("div"),{[pre]:false});if(answerDiv[pre]===false){answerDiv.id="HACKERMAN";document.querySelector(".prodigi-bottom-panel").after(answerDiv);answerDiv.style.position="relative";answerDiv.style.backgroundColor="#696969";answerDiv.style.zIndex="100000";answerDiv.style.border="1px solid white"}this.answerDiv=()=>answerDiv;return this.answerDiv()}};const playButton=document.querySelector(".play");if(playButton){playButton.addEventListener("click",()=>findAnswer())}